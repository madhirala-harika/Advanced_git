code for version2.0
some bug fixes happened